---
title: UBloodStainSubsystem
category: 3. Blueprint API
order: 1
---

[StartRecording](#section1)


## Overview

BloodStain recording and playback subsystem.

A GameInstanceSubsystem responsible for:

- Real-time recording of actor and component transforms
- Transform quantization and compression based on user settings
- Saving and loading replay data to local files with header/body caching
- Exposing Blueprint-callable APIs for recording and replay control


<br/>


## References

| Plugin | `BloodStainSystem` |
| Module | `BloodStainSystem` |
| Header | `#include "BloodStainSubSystem.h"` |
| Source | `/Plugins/BloodStainSystem/Source/BloodStainSystem/Private/BloodStainSubSystem.cpp` |
| Super Class | `UGameInstanceSubsystem` |

<br/>


## Properties

| Type | Name | Description |
|------------------|------------------|------------------------------|
| FileSaveOptions | FBloodStainFileOptions | File's save options. |
| OnCompleteBuildRecordingHeader | FOnBuildRecordingHeader | Just before saving the file, a broadcast is triggered. This can be used to modify or assign the header data. |
| TArray&lt;TObjectPtr&lt;ABloodStainActor&gt;&gt; | BloodStainActors | Spawned Blood Stains |


<br/>


## Functions


<a id="section1"></a>

### Start Recording

<img src="../../images/BloodStainSubSystem/StartRecording.png" width="300" />	


#### Description

>If the group is already recording, join the group <br/>
Record Component is Attached to the Target Actor <br/> <br/>
Notes – This does not handle the case where the Actor is already being recorded in another Group. If called in such a scenario, it will return `false`.

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| AActor* | Target Actor | The actor to record |
| FRecordOptions (Optional) | Options | Optional recording options |

#### Outputs

| Type | Name | Description |
|------|------|-------------|
| bool | Return Value | Whether the recording start is successful. If Actor is Already Recording for Target Group, return `false`. |

<br>




## Start Recording With Actors
<img src="../../images/BloodStainSubSystem/StartRecordingWithActors.png" width="300" />	

#### Description

>If the group is already recording, join the group <br>
Record Component is Attached to the Target Actor <br/><br/>
Notes – This does not handle the case where the Actor is already being recorded in another Group. If called in such a scenario, it will return `false`.

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| TArray&lt;AActor*&gt; | Target Actors | The actors to record |
| FRecordOptions (Optional) | Record Options | Optional recording options |

#### Outputs

| Type | Name | Description |
|------|------|-------------|
| bool | Return Value | whether the recording start is successful |

<br>





## Stop Recording
<img src="../../images/StopRecording.png" width="300" />

#### Description

>Stop Recording Group. All RecordComponents in the Group will be deleted.


#### Inputs

| Type | Name | Description |
|------|------|-------------|
| FName (Optional) | Group Name | Optional group name for organizing recordings |
| bool | Save Recording Data | if false, do not save |

<br>




## Stop Recording RecordComponent
<img src="../../images/StopRecordingRecordComponent.png" width="300" />

#### Description

>Stop recording actor.<br>
Group don't stop recording. if you want to stop recording group, use `UBloodStainSubsystem::StopRecord`


#### Inputs

| Type | Name | Description |
|------|------|-------------|
| URecordComponent | Record Component | Target Record Component |
| bool | Save Recording Data | if false, do not save |

<br>




## Start Replay From File
<img src="../../images/StartReplayFromFile.png" width="300" />

#### Description

> Starts a replay directly from a file. <br/>
Loads the replay data from disk (if not cached) and spawns replay actors.

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| FString | File Name | File Name |
| FString | Level Name | Level Name |
| FBloodStainPlaybackOptions (Optional) | In Playback Options | Optional playback options |


#### Outputs

| Type | Name | Description |
|------|------|-------------|
| FGuid | Out Guid | Replaying Group Key |
| bool | return value | whether the start replay is successful |

<br>


## Start Replay by BloodStain
<img src="../../images/StartReplaybyBloodStain.png" width="300" />

#### Description

> Starts a replay using a `BloodStainActor` instance in the world. <br/>
A user-friendly wrapper that calls `StartReplayFromFile()` with info from the actor.


#### Inputs

| Type | Name | Description |
|------|------|-------------|
| ABloodStainActor* | Blood Stain Actor | BloodStain Actor |


#### Outputs

| Type | Name | Description |
|------|------|-------------|
| FGuid | Out Guid | Replaying Group Key |
| bool | return value | whether the start replay is successful |

<br>



## Stop Replay
<img src="../../images/StopReplay.png" width="300" />

#### Description

> Forcefully stops an entire replay session identified by its key. <br>
Immediately destroys all actors within the group and removes the session from management from the subsystem's management.

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| FGuid | Playback Key | Target Playback Key |

<br>



## Stop Replay PlayComponent
<img src="../../images/StopReplayplayComponent.png" width="300" />

#### Description

>This don't stop All Actors Playback. if you want to stop All of them, use `UBloodStainSubsystem::StopReplay`


#### Inputs

| Type | Name | Description |
|------|------|-------------|
| AReplayActor* | Ghost Actor | Target Playback ReplayActor |

<br>



## GetPlaybackGroup

<img src="../../images/BloodStainSubSystem/GetPlaybackGroup.png" width="300" />

#### Description

> Get Playback Group by Guid (Created by StartReplay)

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| FGuid | In Guid | Playback Key |


#### Outputs

| Type | Name | Description |
|------|------|-------------|
| FBloodStainPlaybackGroup& | OutBloodStainPlaybackGroup | Replaying Playback Group |
| bool | return value | Whether the Playback Group is Exist |

<br>



## Is Playing
<img src="../../images/BloodStainSubSystem/IsPlaying.png" width="300" />

#### Description

> Whether playback group is Playing

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| FGuid | InPlaybackKey | Playback Key |


#### Outputs

| Type | Name | Description |
|------|------|-------------|
| bool | return value | Whether the Playback Group is Replaying |

<br>



## SetRecordingGroupMainActor

<img src="../../images/BloodStainSubSystem/SetRecordingGroupMainActor.png" width="300" />

#### Description

> Set Main Actor for specify the `SpawnPointTransform` position <br>
If null, it is set to the middle position of the Actors.

#### Inputs

| Type | Name | Description |
|------|------|-------------|
| AActor* | Target Actor | Group의 Main Actor |
| FName (Optional) | GroupName | Group's Main Actor for Spawn Transform |

<br>





# TODO - Function 

LoadAllHeadersInLevel
LoadAllHeadersInLevels
LoadAllHeaders

FindOrLoadRecordHeader
FindOrLoadRecordBodyData

IsFileHeaderLoaded
IsFileBodyLoaded

GetCachedHeaders
GetCachedHeadersByTags

ClearCachedData
ClearCachedBodyData

ClearAllCachedData
ClearAllCachedBodyData

DeleteFile

SetDefaultGroupName

SetReplayUserGroupData

GetFullFilePath
GetRelativeFilePath

GetSavedLevelNames
GetSavedFileNames

SetDefaultMaterial
GetDefaultMaterial

SpawnBloodStain
SpawnAllBloodStainInLevel




AddToPendingGroup
AddToPendingGroupWithActors

RemoveFromPendingGroup
RemoveFromPendingGroupWithActors

StartRecordingWithPendingGroup

SetPendingGroupMainActor

SetPendingActorUserData
